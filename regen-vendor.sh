#!/bin/bash
#
# Copyright (C) 2019-2021 The LineageOS Project
#
# SPDX-License-Identifier: Apache-2.0
#

set -e

# Load extract_utils and do some sanity checks
MY_DIR="${BASH_SOURCE%/*}"
if [[ ! -d "${MY_DIR}" ]]; then MY_DIR="${PWD}"; fi

ANDROID_ROOT="${MY_DIR}/../../.."

HELPER="${ANDROID_ROOT}/tools/extract-utils/extract_utils.sh"
if [ ! -f "${HELPER}" ]; then
    echo "Unable to find helper script at ${HELPER}"
    exit 1
fi
source "${HELPER}"

_input_image="${1}"
_output_file="${2}"

if [ -z "${_input_image}" ]; then
    echo "No input image supplied"
    exit 1
fi

if [ -z "${_output_file}" ]; then
    echo "No output filename supplied"
    exit 1
fi

VENDOR_SKIP_FILES=(
    # Standard build output with vendor image build enabled
    "bin/["
    "bin/acpi"
    "bin/awk"
    "bin/base64"
    "bin/basename"
    "bin/blockdev"
    "bin/boringssl_self_test32"
    "bin/boringssl_self_test64"
    "bin/cal"
    "bin/cat"
    "bin/chattr"
    "bin/chcon"
    "bin/checkpoint_gc"
    "bin/chgrp"
    "bin/chmod"
    "bin/chown"
    "bin/chroot"
    "bin/chrt"
    "bin/cksum"
    "bin/clear"
    "bin/cmp"
    "bin/comm"
    "bin/cp"
    "bin/cpio"
    "bin/cut"
    "bin/date"
    "bin/dd"
    "bin/devmem"
    "bin/df"
    "bin/diff"
    "bin/dirname"
    "bin/dmesg"
    "bin/dos2unix"
    "bin/du"
    "bin/dumpsys"
    "bin/echo"
    "bin/egrep"
    "bin/env"
    "bin/expand"
    "bin/expr"
    "bin/fallocate"
    "bin/false"
    "bin/fgrep"
    "bin/file"
    "bin/find"
    "bin/flock"
    "bin/fmt"
    "bin/free"
    "bin/fsync"
    "bin/getconf"
    "bin/getenforce"
    "bin/getevent"
    "bin/getprop"
    "bin/grep"
    "bin/groups"
    "bin/gunzip"
    "bin/gzip"
    "bin/head"
    "bin/hostname"
    "bin/hw/android.hardware.atrace@1.0-service.pixel"
    "bin/hw/android.hardware.audio.service"
    "bin/hw/android.hardware.boot@1.2-service"
    "bin/hw/android.hardware.camera.provider@2.7-service-google"
    "bin/hw/android.hardware.cas@1.2-service"
    "bin/hw/android.hardware.contexthub-service.generic"
    "bin/hw/android.hardware.drm-service.clearkey"
    "bin/hw/android.hardware.dumpstate@1.1-service.redfin"
    "bin/hw/android.hardware.health.storage@1.0-service"
    "bin/hw/android.hardware.health@2.1-service"
    "bin/hw/android.hardware.media.omx@1.0-service"
    "bin/hw/android.hardware.memtrack@1.0-service"
    "bin/hw/android.hardware.nfc-service.st"
    "bin/hw/android.hardware.power-service.pixel-libperfmgr"
    "bin/hw/android.hardware.power.stats@1.0-service.pixel"
    "bin/hw/android.hardware.secure_element@1.2-service.st"
    "bin/hw/android.hardware.thermal@2.0-service.pixel"
    "bin/hw/android.hardware.usb-service.redfin"
    "bin/hw/android.hardware.usb.gadget-service.redfin"
    "bin/hw/android.hardware.vibrator-service.redfin"
    "bin/hw/android.hardware.wifi@1.0-service"
    "bin/hw/hostapd"
    "bin/hw/wait_for_strongbox"
    "bin/hw/wpa_supplicant"
    "bin/hwclock"
    "bin/i2cdetect"
    "bin/i2cdump"
    "bin/i2cget"
    "bin/i2cset"
    "bin/iconv"
    "bin/id"
    "bin/ifconfig"
    "bin/init.gadgethal.sh"
    "bin/init.insmod.sh"
    "bin/init.modem.sh"
    "bin/init.radio.sh"
    "bin/init.ramoops.sh"
    "bin/init.sensors.sh"
    "bin/inotifyd"
    "bin/insmod"
    "bin/install"
    "bin/ionice"
    "bin/iorenice"
    "bin/kill"
    "bin/killall"
    "bin/ln"
    "bin/load_policy"
    "bin/log"
    "bin/logname"
    "bin/logwrapper"
    "bin/losetup"
    "bin/ls"
    "bin/lsattr"
    "bin/lsmod"
    "bin/lsof"
    "bin/lspci"
    "bin/lsusb"
    "bin/md5sum"
    "bin/microcom"
    "bin/misc_writer"
    "bin/mkdir"
    "bin/mkfifo"
    "bin/mknod"
    "bin/mkswap"
    "bin/mktemp"
    "bin/modinfo"
    "bin/modprobe"
    "bin/more"
    "bin/mount"
    "bin/mountpoint"
    "bin/mv"
    "bin/nc"
    "bin/netcat"
    "bin/netstat"
    "bin/nice"
    "bin/nl"
    "bin/nohup"
    "bin/nproc"
    "bin/nsenter"
    "bin/od"
    "bin/paste"
    "bin/patch"
    "bin/pgrep"
    "bin/pidof"
    "bin/pixelstats-vendor"
    "bin/pkill"
    "bin/pmap"
    "bin/printenv"
    "bin/printf"
    "bin/ps"
    "bin/pwd"
    "bin/readelf"
    "bin/readlink"
    "bin/realpath"
    "bin/renice"
    "bin/restorecon"
    "bin/rm"
    "bin/rmdir"
    "bin/rmmod"
    "bin/rtcwake"
    "bin/runcon"
    "bin/sed"
    "bin/sendevent"
    "bin/seq"
    "bin/setenforce"
    "bin/setprop"
    "bin/setsid"
    "bin/sh"
    "bin/sha1sum"
    "bin/sha224sum"
    "bin/sha256sum"
    "bin/sha384sum"
    "bin/sha512sum"
    "bin/sleep"
    "bin/sort"
    "bin/split"
    "bin/start"
    "bin/stat"
    "bin/stop"
    "bin/strings"
    "bin/stty"
    "bin/swapoff"
    "bin/swapon"
    "bin/sync"
    "bin/sysctl"
    "bin/tac"
    "bin/tail"
    "bin/tar"
    "bin/taskset"
    "bin/tee"
    "bin/test"
    "bin/thermal_symlinks"
    "bin/time"
    "bin/timeout"
    "bin/toolbox"
    "bin/top"
    "bin/touch"
    "bin/toybox_vendor"
    "bin/tr"
    "bin/true"
    "bin/truncate"
    "bin/tty"
    "bin/uclampset"
    "bin/ulimit"
    "bin/umount"
    "bin/uname"
    "bin/uniq"
    "bin/unix2dos"
    "bin/unlink"
    "bin/unshare"
    "bin/uptime"
    "bin/usleep"
    "bin/uudecode"
    "bin/uuencode"
    "bin/uuidgen"
    "bin/vmstat"
    "bin/vndservice"
    "bin/vndservicemanager"
    "bin/watch"
    "bin/wc"
    "bin/which"
    "bin/whoami"
    "bin/xargs"
    "bin/xxd"
    "bin/yes"
    "bin/zcat"
    "build.prop"
    "etc/NOTICE.xml.gz"
    "etc/a2dp_audio_policy_configuration.xml"
    "etc/a2dp_in_audio_policy_configuration_7_0.xml"
    "etc/acdbdata/Bluetooth_cal.acdb"
    "etc/acdbdata/General_cal.acdb"
    "etc/acdbdata/Global_cal.acdb"
    "etc/acdbdata/Handset_cal.acdb"
    "etc/acdbdata/Hdmi_cal.acdb"
    "etc/acdbdata/Headset_cal.acdb"
    "etc/acdbdata/Speaker_cal.acdb"
    "etc/acdbdata/adsp_avs_config.acdb"
    "etc/audio_configs.xml"
    "etc/audio_effects.xml"
    "etc/audio_io_policy.conf"
    "etc/audio_platform_info_noextcodec_snd.xml"
    "etc/audio_policy_configuration.xml"
    "etc/audio_policy_configuration_a2dp_offload_disabled.xml"
    "etc/audio_policy_configuration_bluetooth_legacy_hal.xml"
    "etc/audio_policy_volumes.xml"
    "etc/audio_thermal_listener.xml"
    "etc/audiozoom.xml"
    "etc/bluetooth_audio_policy_configuration_7_0.xml"
    "etc/bluetooth_hearing_aid_audio_policy_configuration.xml"
    "etc/bluetooth_power_limits.csv"
    "etc/bluetooth_power_limits_EU.csv"
    "etc/bluetooth_power_limits_JP.csv"
    "etc/bluetooth_power_limits_US.csv"
    "etc/crus_sp_cal_mixer_paths.xml"
    "etc/default_volume_tables.xml"
    "etc/displayconfig/display_id_4630946523002478721.xml"
    "etc/fs_config_dirs"
    "etc/fs_config_files"
    "etc/fstab.persist"
    "etc/fstab.sm7250"
    "etc/gps.conf"
    "etc/group"
    "etc/hearing_aid_audio_policy_configuration_7_0.xml"
    "etc/init.insmod.charger.cfg"
    "etc/init.insmod.redfin.cfg"
    "etc/init/android.hardware.atrace@1.0-service.pixel.rc"
    "etc/init/android.hardware.audio.service.rc"
    "etc/init/android.hardware.boot@1.2-service.rc"
    "etc/init/android.hardware.camera.provider@2.7-service-google.rc"
    "etc/init/android.hardware.cas@1.2-service.rc"
    "etc/init/android.hardware.contexthub-service.generic.rc"
    "etc/init/android.hardware.drm-service.clearkey.rc"
    "etc/init/android.hardware.dumpstate@1.1-service.redfin.rc"
    "etc/init/android.hardware.health.storage@1.0-service.rc"
    "etc/init/android.hardware.health@2.1-service.rc"
    "etc/init/android.hardware.media.omx@1.0-service.rc"
    "etc/init/android.hardware.memtrack@1.0-service.rc"
    "etc/init/android.hardware.power-service.pixel-libperfmgr.rc"
    "etc/init/android.hardware.power.stats@1.0-service.pixel.rc"
    "etc/init/android.hardware.secure_element@1.2-service.st.rc"
    "etc/init/android.hardware.thermal@2.0-service.pixel.rc"
    "etc/init/android.hardware.usb-service.rc"
    "etc/init/android.hardware.usb.gadget-service.redfin.rc"
    "etc/init/android.hardware.vibrator-service.redfin.rc"
    "etc/init/android.hardware.wifi.supplicant-service.rc"
    "etc/init/android.hardware.wifi@1.0-service.rc"
    "etc/init/boringssl_self_test.rc"
    "etc/init/hostapd.android.rc"
    "etc/init/hw/init.redfin.rc"
    "etc/init/hw/init.sm7250.diag.rc"
    "etc/init/hw/init.sm7250.logging.rc"
    "etc/init/hw/init.sm7250.mpssrfs.rc"
    "etc/init/hw/init.sm7250.power.rc"
    "etc/init/hw/init.sm7250.rc"
    "etc/init/hw/init.sm7250.usb.rc"
    "etc/init/init.pixel.rc"
    "etc/init/nfc-service-default.rc"
    "etc/init/pixel-mm.rc"
    "etc/init/pixel-thermal-symlinks.rc"
    "etc/init/pixelstats-vendor.redbull.rc"
    "etc/init/vndservicemanager.rc"
    "etc/libese-hal-st.conf"
    "etc/libnfc-hal-st.conf"
    "etc/media_codecs.xml"
    "etc/media_codecs_c2.xml"
    "etc/media_codecs_google_audio.xml"
    "etc/media_codecs_google_telephony.xml"
    "etc/media_codecs_google_video.xml"
    "etc/media_codecs_omx.xml"
    "etc/media_codecs_performance_c2.xml"
    "etc/media_profiles_V1_0.xml"
    "etc/mixer_paths_noextcodec_snd.xml"
    "etc/mkshrc"
    "etc/passwd"
    "etc/permissions/android.hardware.audio.low_latency.xml"
    "etc/permissions/android.hardware.audio.pro.xml"
    "etc/permissions/android.hardware.bluetooth.xml"
    "etc/permissions/android.hardware.bluetooth_le.xml"
    "etc/permissions/android.hardware.camera.concurrent.xml"
    "etc/permissions/android.hardware.camera.flash-autofocus.xml"
    "etc/permissions/android.hardware.camera.front.xml"
    "etc/permissions/android.hardware.camera.full.xml"
    "etc/permissions/android.hardware.camera.raw.xml"
    "etc/permissions/android.hardware.context_hub.xml"
    "etc/permissions/android.hardware.device_unique_attestation.xml"
    "etc/permissions/android.hardware.fingerprint.xml"
    "etc/permissions/android.hardware.location.gps.xml"
    "etc/permissions/android.hardware.nfc.ese.xml"
    "etc/permissions/android.hardware.nfc.hce.xml"
    "etc/permissions/android.hardware.nfc.hcef.xml"
    "etc/permissions/android.hardware.nfc.uicc.xml"
    "etc/permissions/android.hardware.nfc.xml"
    "etc/permissions/android.hardware.opengles.aep.xml"
    "etc/permissions/android.hardware.reboot_escrow.xml"
    "etc/permissions/android.hardware.se.omapi.ese.xml"
    "etc/permissions/android.hardware.se.omapi.uicc.xml"
    "etc/permissions/android.hardware.strongbox_keystore.xml"
    "etc/permissions/android.hardware.telephony.carrierlock.xml"
    "etc/permissions/android.hardware.telephony.cdma.xml"
    "etc/permissions/android.hardware.telephony.gsm.xml"
    "etc/permissions/android.hardware.telephony.ims.xml"
    "etc/permissions/android.hardware.touchscreen.multitouch.jazzhand.xml"
    "etc/permissions/android.hardware.usb.accessory.xml"
    "etc/permissions/android.hardware.usb.host.xml"
    "etc/permissions/android.hardware.vulkan.compute.xml"
    "etc/permissions/android.hardware.vulkan.level.xml"
    "etc/permissions/android.hardware.vulkan.version.xml"
    "etc/permissions/android.hardware.wifi.aware.xml"
    "etc/permissions/android.hardware.wifi.direct.xml"
    "etc/permissions/android.hardware.wifi.passpoint.xml"
    "etc/permissions/android.hardware.wifi.rtt.xml"
    "etc/permissions/android.hardware.wifi.xml"
    "etc/permissions/android.software.device_id_attestation.xml"
    "etc/permissions/android.software.midi.xml"
    "etc/permissions/android.software.opengles.deqp.level.xml"
    "etc/permissions/android.software.sip.voip.xml"
    "etc/permissions/android.software.verified_boot.xml"
    "etc/permissions/android.software.vulkan.deqp.level.xml"
    "etc/permissions/aosp_excluded_hardware.xml"
    "etc/permissions/com.nxp.mifare.xml"
    "etc/permissions/handheld_core_hardware.xml"
    "etc/powerhint.json"
    "etc/r_submix_audio_policy_configuration.xml"
    "etc/sec_config"
    "etc/seccomp_policy/mediacodec.policy"
    "etc/selinux/plat_pub_versioned.cil"
    "etc/selinux/plat_sepolicy_vers.txt"
    "etc/selinux/precompiled_sepolicy"
    "etc/selinux/precompiled_sepolicy.plat_sepolicy_and_mapping.sha256"
    "etc/selinux/precompiled_sepolicy.product_sepolicy_and_mapping.sha256"
    "etc/selinux/precompiled_sepolicy.system_ext_sepolicy_and_mapping.sha256"
    "etc/selinux/selinux_denial_metadata"
    "etc/selinux/vendor_file_contexts"
    "etc/selinux/vendor_hwservice_contexts"
    "etc/selinux/vendor_mac_permissions.xml"
    "etc/selinux/vendor_property_contexts"
    "etc/selinux/vendor_seapp_contexts"
    "etc/selinux/vendor_sepolicy.cil"
    "etc/selinux/vendor_service_contexts"
    "etc/selinux/vndservice_contexts"
    "etc/sound_trigger_mixer_paths.xml"
    "etc/sound_trigger_platform_info.xml"
    "etc/sysconfig/component-overrides.xml"
    "etc/task_profiles.json"
    "etc/thermal_info_config.json"
    "etc/usb_audio_policy_configuration.xml"
    "etc/video_system_specs.json"
    "etc/vintf/compatibility_matrix.xml"
    "etc/vintf/manifest.xml"
    "etc/vintf/manifest/android.hardware.atrace@1.0-service.pixel.xml"
    "etc/vintf/manifest/android.hardware.boot@1.2.xml"
    "etc/vintf/manifest/android.hardware.camera.provider@2.7-service-google.xml"
    "etc/vintf/manifest/android.hardware.cas@1.2-service.xml"
    "etc/vintf/manifest/android.hardware.contexthub-service.generic.xml"
    "etc/vintf/manifest/android.hardware.drm-service.clearkey.xml"
    "etc/vintf/manifest/android.hardware.health@2.1.xml"
    "etc/vintf/manifest/android.hardware.power-service.pixel.xml"
    "etc/vintf/manifest/android.hardware.thermal@2.0-service.pixel.xml"
    "etc/vintf/manifest/android.hardware.usb-service.xml"
    "etc/vintf/manifest/android.hardware.usb.gadget@1.1-service.redfin.xml"
    "etc/vintf/manifest/android.hardware.vibrator-service.redfin.xml"
    "etc/vintf/manifest/android.hardware.wifi.hostapd.xml"
    "etc/vintf/manifest/android.hardware.wifi.supplicant.xml"
    "etc/vintf/manifest/android.hardware.wifi@1.0-service.xml"
    "etc/vintf/manifest/manifest_android.hardware.health.storage@1.0.xml"
    "etc/vintf/manifest/nfc-service-default.xml"
    "etc/wifi/p2p_supplicant_overlay.conf"
    "etc/wifi/wifi_concurrency_cfg.txt"
    "etc/wifi/wpa_supplicant.conf"
    "etc/wifi/wpa_supplicant_overlay.conf"
    "firmware/R-cs35l41-dsp1-spk-cali.bin"
    "firmware/R-cs35l41-dsp1-spk-prot.bin"
    "firmware/R-cs35l41-revB0-dsp1-spk-cali.bin"
    "firmware/R-cs35l41-revB0-dsp1-spk-prot.bin"
    "firmware/R-cs35l41-revB2-dsp1-spk-cali.bin"
    "firmware/R-cs35l41-revB2-dsp1-spk-prot.bin"
    "firmware/cs35l41-dsp1-spk-cali.bin"
    "firmware/cs35l41-dsp1-spk-cali.wmfw"
    "firmware/cs35l41-dsp1-spk-prot.bin"
    "firmware/cs35l41-dsp1-spk-prot.wmfw"
    "firmware/cs35l41-revB0-dsp1-spk-cali.bin"
    "firmware/cs35l41-revB0-dsp1-spk-cali.wmfw"
    "firmware/cs35l41-revB0-dsp1-spk-prot.bin"
    "firmware/cs35l41-revB0-dsp1-spk-prot.wmfw"
    "firmware/cs35l41-revB2-dsp1-spk-cali.bin"
    "firmware/cs35l41-revB2-dsp1-spk-cali.wmfw"
    "firmware/cs35l41-revB2-dsp1-spk-prot.bin"
    "firmware/cs35l41-revB2-dsp1-spk-prot.wmfw"
    "firmware/drv2624.bin"
    "firmware/rt5514_dsp_fw1.bin"
    "firmware/rt5514_dsp_fw2.bin"
    "firmware/rt5514_dsp_fw3.bin"
    "firmware/rt5514_dsp_fw4.bin"
    "firmware/rt5514p_dsp_fw1.bin"
    "firmware/rt5514p_dsp_fw2.bin"
    "firmware/rt5514p_dsp_fw3.bin"
    "firmware/rt5514p_dsp_fw4.bin"
    "firmware/wlan/qca_cld/WCNSS_qcom_cfg.ini"
    "lib/android.frameworks.stats-V1-ndk.so"
    "lib/android.hardware.audio.common-util.so"
    "lib/android.hardware.audio.common@5.0.so"
    "lib/android.hardware.audio.common@7.0-enums.so"
    "lib/android.hardware.audio.common@7.0-util.so"
    "lib/android.hardware.audio.common@7.0.so"
    "lib/android.hardware.audio.effect@7.0-util.so"
    "lib/android.hardware.audio.effect@7.0.so"
    "lib/android.hardware.audio@7.0-util.so"
    "lib/android.hardware.audio@7.0.so"
    "lib/android.hardware.bluetooth.audio@2.0.so"
    "lib/android.hardware.bluetooth.audio@2.1.so"
    "lib/android.hardware.boot@1.0.so"
    "lib/android.hardware.boot@1.1.so"
    "lib/android.hardware.boot@1.2.so"
    "lib/android.hardware.cas.native@1.0.so"
    "lib/android.hardware.cas@1.0.so"
    "lib/android.hardware.cas@1.1.so"
    "lib/android.hardware.cas@1.2.so"
    "lib/android.hardware.health@1.0.so"
    "lib/android.hardware.health@2.0.so"
    "lib/android.hardware.health@2.1.so"
    "lib/android.hardware.radio@1.0.so"
    "lib/android.hardware.radio@1.1.so"
    "lib/android.hardware.soundtrigger@2.1.so"
    "lib/android.hardware.soundtrigger@2.2.so"
    "lib/android.hardware.soundtrigger@2.3.so"
    "lib/android.hidl.allocator@1.0.so"
    "lib/hw/android.hardware.audio.effect@7.0-impl.so"
    "lib/hw/android.hardware.audio@7.0-impl.so"
    "lib/hw/android.hardware.bluetooth.audio@2.0-impl.so"
    "lib/hw/android.hardware.boot@1.0-impl-1.2-pixel-legacy.so"
    "lib/hw/android.hardware.health@2.0-impl-2.1-redbull.so"
    "lib/hw/android.hardware.memtrack@1.0-impl.so"
    "lib/hw/android.hardware.renderscript@1.0-impl.so"
    "lib/hw/android.hardware.soundtrigger@2.3-impl.so"
    "lib/hw/audio.bluetooth.default.so"
    "lib/hw/audio.primary.default.so"
    "lib/hw/audio.r_submix.default.so"
    "lib/hw/audio.usb.default.so"
    "lib/hw/bootctrl.lito.so"
    "lib/hw/gralloc.default.so"
    "lib/hw/local_time.default.so"
    "lib/hw/power.default.so"
    "lib/hw/vibrator.default.so"
    "lib/libalsautils.so"
    "lib/libavservices_minijail.so"
    "lib/libbatching.so"
    "lib/libbluetooth_audio_session.so"
    "lib/libbluetooth_audio_session_aidl.so"
    "lib/libeffects.so"
    "lib/libeffectsconfig.so"
    "lib/libgeofencing.so"
    "lib/libgnss.so"
    "lib/libgps.utils.so"
    "lib/libloc_core.so"
    "lib/liblocation_api.so"
    "lib/libmediautils_vendor.so"
    "lib/libmemunreachable.so"
    "lib/libnbaio_mono.so"
    "lib/libopus.so"
    "lib/libpixelhealth.so"
    "lib/libprotobuf-cpp-full-3.9.1.so"
    "lib/libprotobuf-cpp-lite-3.9.1.so"
    "lib/libreference-ril.so"
    "lib/libril.so"
    "lib/librilutils.so"
    "lib/libstagefright_amrnb_common.so"
    "lib/libstagefright_enc_common.so"
    "lib/libstagefright_flacdec.so"
    "lib/libstagefright_soft_aacdec.so"
    "lib/libstagefright_soft_aacenc.so"
    "lib/libstagefright_soft_amrdec.so"
    "lib/libstagefright_soft_amrnbenc.so"
    "lib/libstagefright_soft_amrwbenc.so"
    "lib/libstagefright_soft_avcdec.so"
    "lib/libstagefright_soft_avcenc.so"
    "lib/libstagefright_soft_flacdec.so"
    "lib/libstagefright_soft_flacenc.so"
    "lib/libstagefright_soft_g711dec.so"
    "lib/libstagefright_soft_gsmdec.so"
    "lib/libstagefright_soft_hevcdec.so"
    "lib/libstagefright_soft_mp3dec.so"
    "lib/libstagefright_soft_mpeg2dec.so"
    "lib/libstagefright_soft_mpeg4dec.so"
    "lib/libstagefright_soft_mpeg4enc.so"
    "lib/libstagefright_soft_opusdec.so"
    "lib/libstagefright_soft_rawdec.so"
    "lib/libstagefright_soft_vorbisdec.so"
    "lib/libstagefright_soft_vpxdec.so"
    "lib/libstagefright_soft_vpxenc.so"
    "lib/libstagefright_softomx.so"
    "lib/libstagefright_softomx_plugin.so"
    "lib/libvibrator.so"
    "lib/libvorbisidec.so"
    "lib/libvpx.so"
    "lib/libwpa_client.so"
    "lib/mediacas/libclearkeycasplugin.so"
    "lib/mediadrm/libdrmclearkeyplugin.so"
    "lib/modules/adc_tm.ko"
    "lib/modules/adsp_loader_dlkm.ko"
    "lib/modules/adsprpc.ko"
    "lib/modules/adsprpc_compat.ko"
    "lib/modules/apr_dlkm.ko"
    "lib/modules/arm-memlat-mon.ko"
    "lib/modules/arm-smmu-debug.ko"
    "lib/modules/arm-smmu.ko"
    "lib/modules/at24.ko"
    "lib/modules/bcl_pmic5.ko"
    "lib/modules/bcl_soc.ko"
    "lib/modules/bimc-bwmon.ko"
    "lib/modules/bluetooth_power.ko"
    "lib/modules/bolero_cdc_dlkm.ko"
    "lib/modules/cam-context.ko"
    "lib/modules/cam-fd-hw-mgr.ko"
    "lib/modules/cam-sensor-io.ko"
    "lib/modules/cam-sync.ko"
    "lib/modules/cam_a5.ko"
    "lib/modules/cam_actuator.ko"
    "lib/modules/cam_bps.ko"
    "lib/modules/cam_cci.ko"
    "lib/modules/cam_cci_late.ko"
    "lib/modules/cam_cdm.ko"
    "lib/modules/cam_cpas.ko"
    "lib/modules/cam_csiphy.ko"
    "lib/modules/cam_custom_context.ko"
    "lib/modules/cam_custom_csid_dev.ko"
    "lib/modules/cam_custom_dev.ko"
    "lib/modules/cam_custom_hw_mgr.ko"
    "lib/modules/cam_custom_sub_mod_core.ko"
    "lib/modules/cam_custom_sub_mod_dev.ko"
    "lib/modules/cam_custom_sub_mod_soc.ko"
    "lib/modules/cam_debug_util.ko"
    "lib/modules/cam_eeprom.ko"
    "lib/modules/cam_fd.ko"
    "lib/modules/cam_flash.ko"
    "lib/modules/cam_gyro_core.ko"
    "lib/modules/cam_hfi.ko"
    "lib/modules/cam_icp.ko"
    "lib/modules/cam_ife_csid.ko"
    "lib/modules/cam_ife_csid17x.ko"
    "lib/modules/cam_ife_csid_lite17x.ko"
    "lib/modules/cam_ife_hw_mgr.ko"
    "lib/modules/cam_ipe.ko"
    "lib/modules/cam_irq_controller.ko"
    "lib/modules/cam_isp.ko"
    "lib/modules/cam_isp_hw_mgr.ko"
    "lib/modules/cam_isp_packet_parser.ko"
    "lib/modules/cam_jpeg.ko"
    "lib/modules/cam_jpeg_dma.ko"
    "lib/modules/cam_jpeg_enc.ko"
    "lib/modules/cam_jpeg_hw_mgr.ko"
    "lib/modules/cam_lrme.ko"
    "lib/modules/cam_lrme_hw.ko"
    "lib/modules/cam_lrme_hw_mgr.ko"
    "lib/modules/cam_mem_mgr.ko"
    "lib/modules/cam_ois.ko"
    "lib/modules/cam_req_mgr.ko"
    "lib/modules/cam_req_mgr_late.ko"
    "lib/modules/cam_res_mgr.ko"
    "lib/modules/cam_sensor.ko"
    "lib/modules/cam_sensor_util.ko"
    "lib/modules/cam_sensor_vsync_dev.ko"
    "lib/modules/cam_sensor_vsync_pb.ko"
    "lib/modules/cam_smmu_api.ko"
    "lib/modules/cam_tasklet_util.ko"
    "lib/modules/cam_utils.ko"
    "lib/modules/cam_vfe.ko"
    "lib/modules/camcc-lito.ko"
    "lib/modules/cdsp-loader.ko"
    "lib/modules/cdsprm.ko"
    "lib/modules/citadel-spi.ko"
    "lib/modules/clk-aop-qmp.ko"
    "lib/modules/clk-qcom.ko"
    "lib/modules/clk-rpmh.ko"
    "lib/modules/clk-spmi-pmic-div.ko"
    "lib/modules/cmd-db.ko"
    "lib/modules/cnss_nl.ko"
    "lib/modules/cnss_prealloc.ko"
    "lib/modules/cnss_utils.ko"
    "lib/modules/core_hang_detect.ko"
    "lib/modules/coresight-clk-amba-placeholder.ko"
    "lib/modules/coresight-clk-placeholder.ko"
    "lib/modules/cpu_isolate.ko"
    "lib/modules/dcc_v2.ko"
    "lib/modules/ddr_stats.ko"
    "lib/modules/debugcc-lito.ko"
    "lib/modules/devfreq_devbw.ko"
    "lib/modules/devfreq_qcom_fw.ko"
    "lib/modules/diagchar.ko"
    "lib/modules/dispcc-lito.ko"
    "lib/modules/dm-user.ko"
    "lib/modules/drv2624.ko"
    "lib/modules/dwc3-haps.ko"
    "lib/modules/dwc3-of-simple.ko"
    "lib/modules/dwc3-qcom.ko"
    "lib/modules/dwc3.ko"
    "lib/modules/early_random.ko"
    "lib/modules/ebtable_broute.ko"
    "lib/modules/ebtables.ko"
    "lib/modules/eud.ko"
    "lib/modules/event_timer.ko"
    "lib/modules/fastcvpd.ko"
    "lib/modules/fpc1020_platform_tee.ko"
    "lib/modules/fsa4480-i2c.ko"
    "lib/modules/ftm5.ko"
    "lib/modules/fw-update.ko"
    "lib/modules/gcc-lito.ko"
    "lib/modules/gladiator_hang_detect.ko"
    "lib/modules/glink_pkt.ko"
    "lib/modules/glink_probe.ko"
    "lib/modules/google-battery.ko"
    "lib/modules/google-bms.ko"
    "lib/modules/google_charger.ko"
    "lib/modules/google_wlan_mac.ko"
    "lib/modules/governor_bw_hwmon.ko"
    "lib/modules/governor_bw_vbif.ko"
    "lib/modules/governor_cdsp_l3.ko"
    "lib/modules/governor_gpubw_mon.ko"
    "lib/modules/governor_memlat.ko"
    "lib/modules/governor_msm_adreno_tz.ko"
    "lib/modules/gpi.ko"
    "lib/modules/gpucc-lito.ko"
    "lib/modules/hdcp_qseecom.ko"
    "lib/modules/hdmi_dlkm.ko"
    "lib/modules/heap_mem_ext_v01.ko"
    "lib/modules/heatmap.ko"
    "lib/modules/i2c-qcom-geni.ko"
    "lib/modules/incrementalfs.ko"
    "lib/modules/iommu-logger.ko"
    "lib/modules/ion-alloc.ko"
    "lib/modules/ipa3.ko"
    "lib/modules/jtagv8-etm.ko"
    "lib/modules/jtagv8.ko"
    "lib/modules/kheaders.ko"
    "lib/modules/lcd.ko"
    "lib/modules/leds-qpnp-flash-common.ko"
    "lib/modules/leds-qpnp-flash-v2.ko"
    "lib/modules/llcc-lito.ko"
    "lib/modules/llcc-orchid.ko"
    "lib/modules/llcc-slice.ko"
    "lib/modules/llcc_perfmon.ko"
    "lib/modules/lmh_cpu_vdd_cdev.ko"
    "lib/modules/lmh_dbg.ko"
    "lib/modules/logbuffer.ko"
    "lib/modules/lpm-stats.ko"
    "lib/modules/machine_dlkm.ko"
    "lib/modules/mbhc_dlkm.ko"
    "lib/modules/mdt_loader.ko"
    "lib/modules/memory_dump_v2.ko"
    "lib/modules/microdump_collector.ko"
    "lib/modules/minidump_log.ko"
    "lib/modules/modemsmem.ko"
    "lib/modules/modules.alias"
    "lib/modules/modules.blocklist"
    "lib/modules/modules.dep"
    "lib/modules/modules.load"
    "lib/modules/modules.softdep"
    "lib/modules/msm-poweroff.ko"
    "lib/modules/msm-vidc.ko"
    "lib/modules/msm_adreno.ko"
    "lib/modules/msm_bus.ko"
    "lib/modules/msm_bus_rpmh.ko"
    "lib/modules/msm_dma_iommu_mapping.ko"
    "lib/modules/msm_drm.ko"
    "lib/modules/msm_ext_display.ko"
    "lib/modules/msm_geni_serial.ko"
    "lib/modules/msm_gsi.ko"
    "lib/modules/msm_hdcp.ko"
    "lib/modules/msm_icnss.ko"
    "lib/modules/msm_ipc_logging.ko"
    "lib/modules/msm_lmh_dcvs.ko"
    "lib/modules/msm_memshare.ko"
    "lib/modules/msm_minidump.ko"
    "lib/modules/msm_npu.ko"
    "lib/modules/msm_pm.ko"
    "lib/modules/msm_qmp.ko"
    "lib/modules/msm_rng.ko"
    "lib/modules/msm_scm.ko"
    "lib/modules/msm_sharedmem.ko"
    "lib/modules/msm_sps.ko"
    "lib/modules/native_dlkm.ko"
    "lib/modules/npucc-lito.ko"
    "lib/modules/nvmem_qfprom.ko"
    "lib/modules/of_batterydata.ko"
    "lib/modules/of_slimbus.ko"
    "lib/modules/overheat_mitigation.ko"
    "lib/modules/p9221_charger.ko"
    "lib/modules/pac193x.ko"
    "lib/modules/peripheral-loader.ko"
    "lib/modules/phy-generic.ko"
    "lib/modules/phy-msm-snps-hs.ko"
    "lib/modules/phy-msm-ssusb-qmp.ko"
    "lib/modules/phy-qcom-ufs-qmp-v3-660.ko"
    "lib/modules/phy-qcom-ufs-qmp-v3.ko"
    "lib/modules/phy-qcom-ufs-qmp-v4-lito.ko"
    "lib/modules/phy-qcom-ufs-qmp-v4.ko"
    "lib/modules/phy-qcom-ufs-qrbtc-sdm845.ko"
    "lib/modules/phy-qcom-ufs.ko"
    "lib/modules/pinctrl-lito.ko"
    "lib/modules/pinctrl-msm.ko"
    "lib/modules/pinctrl-spmi-gpio.ko"
    "lib/modules/pinctrl-spmi-mpp.ko"
    "lib/modules/pinctrl_lpi_dlkm.ko"
    "lib/modules/platform_dlkm.ko"
    "lib/modules/pmic-voter.ko"
    "lib/modules/pwm-qti-lpg.ko"
    "lib/modules/q6_dlkm.ko"
    "lib/modules/q6_notifier_dlkm.ko"
    "lib/modules/q6_pdr_dlkm.ko"
    "lib/modules/qce50.ko"
    "lib/modules/qcedev-module.ko"
    "lib/modules/qcom-cpufreq-hw.ko"
    "lib/modules/qcom-geni-se.ko"
    "lib/modules/qcom-i2c-pmic.ko"
    "lib/modules/qcom-pdc.ko"
    "lib/modules/qcom-spmi-adc5.ko"
    "lib/modules/qcom-spmi-pmic.ko"
    "lib/modules/qcom-spmi-sdam.ko"
    "lib/modules/qcom-spmi-temp-alarm.ko"
    "lib/modules/qcom-spmi-wled.ko"
    "lib/modules/qcom-vadc-common.ko"
    "lib/modules/qcom_edac.ko"
    "lib/modules/qcom_glink_native.ko"
    "lib/modules/qcom_glink_smem.ko"
    "lib/modules/qcom_glink_spss.ko"
    "lib/modules/qcom_hwspinlock.ko"
    "lib/modules/qcom_ipcc.ko"
    "lib/modules/qcom_llcc_pmu.ko"
    "lib/modules/qcom_rpmh.ko"
    "lib/modules/qcom_socinfo.ko"
    "lib/modules/qcrypto.ko"
    "lib/modules/qmi_cdev.ko"
    "lib/modules/qmi_helpers.ko"
    "lib/modules/qpnp-amoled-regulator.ko"
    "lib/modules/qpnp-battery.ko"
    "lib/modules/qpnp-power-on.ko"
    "lib/modules/qpnp-qgauge.ko"
    "lib/modules/qpnp-revid.ko"
    "lib/modules/qpnp-smb5-charger.ko"
    "lib/modules/qpnp_pdphy.ko"
    "lib/modules/qrtr-smd.ko"
    "lib/modules/qrtr.ko"
    "lib/modules/qseecom.ko"
    "lib/modules/qtee_shm_bridge.ko"
    "lib/modules/qti_qmi_sensor.ko"
    "lib/modules/ramdump.ko"
    "lib/modules/rdbg.ko"
    "lib/modules/refgen.ko"
    "lib/modules/regmap-spmi.ko"
    "lib/modules/regulator_aop_cdev.ko"
    "lib/modules/rmnet.ko"
    "lib/modules/rndis.ko"
    "lib/modules/roles.ko"
    "lib/modules/rpm_stats.ko"
    "lib/modules/rpmh-regulator.ko"
    "lib/modules/rpmh_master_stat.ko"
    "lib/modules/rpmsg_char.ko"
    "lib/modules/rpmsg_core.ko"
    "lib/modules/rq_stats.ko"
    "lib/modules/rtc-pm8xxx.ko"
    "lib/modules/rx_macro_dlkm.ko"
    "lib/modules/sctp.ko"
    "lib/modules/sctp_diag.ko"
    "lib/modules/sec_touch.ko"
    "lib/modules/secure_buffer.ko"
    "lib/modules/service-locator.ko"
    "lib/modules/service-notifier.ko"
    "lib/modules/slg51000-regulator.ko"
    "lib/modules/slim_msm_ngd.ko"
    "lib/modules/slimbus.ko"
    "lib/modules/sm7250_bms.ko"
    "lib/modules/smcinvoke.ko"
    "lib/modules/smem.ko"
    "lib/modules/smem_state.ko"
    "lib/modules/smp2p.ko"
    "lib/modules/smp2p_sleepstate.ko"
    "lib/modules/snd-soc-codec-misc.ko"
    "lib/modules/snd-soc-cs35l41-i2c.ko"
    "lib/modules/snd-soc-cs35l41.ko"
    "lib/modules/snd-soc-rl6231.ko"
    "lib/modules/snd-soc-rt5514-qmi.ko"
    "lib/modules/snd-soc-rt5514-spi.ko"
    "lib/modules/snd-soc-rt5514.ko"
    "lib/modules/snd-soc-wm-adsp.ko"
    "lib/modules/snd_event_dlkm.ko"
    "lib/modules/spi-geni-qcom.ko"
    "lib/modules/spmi-pmic-arb.ko"
    "lib/modules/st21nfc.ko"
    "lib/modules/st54j_se.ko"
    "lib/modules/stub_dlkm.ko"
    "lib/modules/subsys-pil-tz.ko"
    "lib/modules/subsystem-restart.ko"
    "lib/modules/subsystem_notif.ko"
    "lib/modules/swr_ctrl_dlkm.ko"
    "lib/modules/swr_dlkm.ko"
    "lib/modules/system_pm.ko"
    "lib/modules/tas256x_dlkm.ko"
    "lib/modules/tcpm.ko"
    "lib/modules/thermal-tsens.ko"
    "lib/modules/touch_offload.ko"
    "lib/modules/touchscreen_tbn.ko"
    "lib/modules/tps-regulator.ko"
    "lib/modules/tx_macro_dlkm.ko"
    "lib/modules/ufs_qcom.ko"
    "lib/modules/ufshcd-core.ko"
    "lib/modules/ufshcd-pltfrm.ko"
    "lib/modules/usb-audio-qmi.ko"
    "lib/modules/usb-dwc3-msm.ko"
    "lib/modules/usb_f_ccid.ko"
    "lib/modules/usb_f_cdev.ko"
    "lib/modules/usb_f_diag.ko"
    "lib/modules/usb_f_gsi.ko"
    "lib/modules/usb_f_mtp.ko"
    "lib/modules/usb_f_ptp.ko"
    "lib/modules/usb_f_qdss.ko"
    "lib/modules/usf_dlkm.ko"
    "lib/modules/va_macro_dlkm.ko"
    "lib/modules/vd6281_module.ko"
    "lib/modules/videocc-lito.ko"
    "lib/modules/virt-dma.ko"
    "lib/modules/watchdog_v2.ko"
    "lib/modules/wcd937x_dlkm.ko"
    "lib/modules/wcd937x_slave_dlkm.ko"
    "lib/modules/wcd938x_dlkm.ko"
    "lib/modules/wcd938x_slave_dlkm.ko"
    "lib/modules/wcd9xxx_dlkm.ko"
    "lib/modules/wcd_core_dlkm.ko"
    "lib/modules/wlan.ko"
    "lib/modules/wsa881x_dlkm.ko"
    "lib/modules/wsa883x_dlkm.ko"
    "lib/modules/wsa_macro_dlkm.ko"
    "lib/modules/xhci-plat-hcd.ko"
    "lib/pixelatoms-cpp.so"
    "lib/soundfx/libaudiopreprocessing.so"
    "lib/soundfx/libbundlewrapper.so"
    "lib/soundfx/libdownmix.so"
    "lib/soundfx/libdynproc.so"
    "lib/soundfx/libeffectproxy.so"
    "lib/soundfx/libhapticgenerator.so"
    "lib/soundfx/libldnhncr.so"
    "lib/soundfx/libqcomvoiceprocessingdescriptors.so"
    "lib/soundfx/libreverbwrapper.so"
    "lib/soundfx/libvisualizer.so"
    "lib64/android.frameworks.sensorservice@1.0.so"
    "lib64/android.frameworks.stats-V1-ndk.so"
    "lib64/android.hardware.atrace@1.0.so"
    "lib64/android.hardware.audio.common@5.0.so"
    "lib64/android.hardware.bluetooth.audio@2.0.so"
    "lib64/android.hardware.bluetooth.audio@2.1.so"
    "lib64/android.hardware.boot@1.0.so"
    "lib64/android.hardware.boot@1.1.so"
    "lib64/android.hardware.boot@1.2.so"
    "lib64/android.hardware.contexthub-V1-ndk.so"
    "lib64/android.hardware.dumpstate@1.0.so"
    "lib64/android.hardware.dumpstate@1.1.so"
    "lib64/android.hardware.health.storage@1.0.so"
    "lib64/android.hardware.health@1.0.so"
    "lib64/android.hardware.health@2.0.so"
    "lib64/android.hardware.health@2.1.so"
    "lib64/android.hardware.keymaster@3.0.so"
    "lib64/android.hardware.keymaster@4.0.so"
    "lib64/android.hardware.keymaster@4.1.so"
    "lib64/android.hardware.power-V1-ndk.so"
    "lib64/android.hardware.power.stats@1.0.so"
    "lib64/android.hardware.radio@1.0.so"
    "lib64/android.hardware.radio@1.1.so"
    "lib64/android.hardware.secure_element@1.0.so"
    "lib64/android.hardware.secure_element@1.1.so"
    "lib64/android.hardware.secure_element@1.2.so"
    "lib64/android.hardware.security.keymint-V1-ndk.so"
    "lib64/android.hardware.sensors@1.0.so"
    "lib64/android.hardware.soundtrigger@2.1.so"
    "lib64/android.hardware.soundtrigger@2.2.so"
    "lib64/android.hardware.soundtrigger@2.3.so"
    "lib64/android.hardware.thermal@1.0.so"
    "lib64/android.hardware.thermal@2.0.so"
    "lib64/android.hardware.usb.gadget@1.0.so"
    "lib64/android.hardware.usb.gadget@1.1.so"
    "lib64/android.hardware.wifi@1.0.so"
    "lib64/android.hardware.wifi@1.1.so"
    "lib64/android.hardware.wifi@1.2.so"
    "lib64/android.hardware.wifi@1.3.so"
    "lib64/android.hardware.wifi@1.4.so"
    "lib64/android.hardware.wifi@1.5.so"
    "lib64/android.hardware.wifi@1.6.so"
    "lib64/android.hidl.allocator@1.0.so"
    "lib64/android.system.keystore2-V1-ndk.so"
    "lib64/android.system.wifi.keystore@1.0.so"
    "lib64/ese_spi_st.so"
    "lib64/hw/android.hardware.bluetooth.audio@2.0-impl.so"
    "lib64/hw/android.hardware.boot@1.0-impl-1.2-pixel-legacy.so"
    "lib64/hw/android.hardware.health@2.0-impl-2.1-redbull.so"
    "lib64/hw/android.hardware.memtrack@1.0-impl.so"
    "lib64/hw/android.hardware.renderscript@1.0-impl.so"
    "lib64/hw/android.hardware.soundtrigger@2.3-impl.so"
    "lib64/hw/audio.bluetooth.default.so"
    "lib64/hw/audio.primary.default.so"
    "lib64/hw/audio.r_submix.default.so"
    "lib64/hw/audio.usb.default.so"
    "lib64/hw/bootctrl.lito.so"
    "lib64/hw/gralloc.default.so"
    "lib64/hw/local_time.default.so"
    "lib64/hw/power.default.so"
    "lib64/hw/vibrator.default.so"
    "lib64/lib_profiler.so"
    "lib64/libadaptivecpu.so"
    "lib64/libalsautils.so"
    "lib64/libbatching.so"
    "lib64/libbinderdebug.so"
    "lib64/libbluetooth_audio_session.so"
    "lib64/libbluetooth_audio_session_aidl.so"
    "lib64/libcld80211.so"
    "lib64/libdisppower-pixel.so"
    "lib64/libeffects.so"
    "lib64/libeffectsconfig.so"
    "lib64/libgeofencing.so"
    "lib64/libgnss.so"
    "lib64/libgooglecamerahal.so"
    "lib64/libgooglecamerahalutils.so"
    "lib64/libgps.utils.so"
    "lib64/libgrallocusage.so"
    "lib64/libkeymaster4_1support.so"
    "lib64/libkeymaster4support.so"
    "lib64/libkeystore-engine-wifi-hidl.so"
    "lib64/libkeystore-wifi-hidl.so"
    "lib64/libloc_core.so"
    "lib64/liblocation_api.so"
    "lib64/libmeminfo.so"
    "lib64/libnbaio_mono.so"
    "lib64/libperfmgr.so"
    "lib64/libpixelhealth.so"
    "lib64/libpixelstats.so"
    "lib64/libprotobuf-cpp-full-3.9.1.so"
    "lib64/libprotobuf-cpp-lite-3.9.1.so"
    "lib64/libreference-ril.so"
    "lib64/libril.so"
    "lib64/librilutils.so"
    "lib64/libsensorndkbridge.so"
    "lib64/libvibrator.so"
    "lib64/libwifi-hal.so"
    "lib64/libwpa_client.so"
    "lib64/mediacas/libclearkeycasplugin.so"
    "lib64/mediadrm/libdrmclearkeyplugin.so"
    "lib64/nfc_nci.st21nfc.default.so"
    "lib64/pixel-power-ext-V1-ndk.so"
    "lib64/pixelatoms-cpp.so"
    "lib64/pixelpowerstats_provider_aidl_interface-cpp.so"
    "lib64/soundfx/libaudiopreprocessing.so"
    "lib64/soundfx/libbundlewrapper.so"
    "lib64/soundfx/libdownmix.so"
    "lib64/soundfx/libdynproc.so"
    "lib64/soundfx/libeffectproxy.so"
    "lib64/soundfx/libhapticgenerator.so"
    "lib64/soundfx/libldnhncr.so"
    "lib64/soundfx/libqcomvoiceprocessingdescriptors.so"
    "lib64/soundfx/libreverbwrapper.so"
    "lib64/soundfx/libvisualizer.so"
    "odm/etc/build.prop"
    "odm/etc/group"
    "odm/etc/passwd"
    "odm_dlkm/etc/build.prop"
    "overlay/EmergencyInfo__auto_generated_rro_vendor.apk"
    "overlay/NfcNci__auto_generated_rro_vendor.apk"
    "overlay/SecureElement__auto_generated_rro_vendor.apk"
    "overlay/Settings__auto_generated_rro_vendor.apk"
    "overlay/StorageManager__auto_generated_rro_vendor.apk"
    "overlay/SystemUI__auto_generated_rro_vendor.apk"
    "overlay/TeleService__auto_generated_rro_vendor.apk"
    "overlay/Traceur__auto_generated_rro_vendor.apk"
    "overlay/framework-res__auto_generated_rro_vendor.apk"
    "ueventd.rc"
    "usr/idc/uinput-fpc.idc"
    "usr/keylayout/uinput-fpc.kl"
    "vendor_dlkm/etc/build.prop"

    # Exclude overlays, symlinks and extra files that we override

    # Overlays
    "overlay/Flipendo__auto_generated_rro_vendor.apk"
    "overlay/HbmSVManager__auto_generated_rro_vendor.apk"
    "overlay/SettingsGoogle__auto_generated_rro_vendor.apk"
    "overlay/StorageManagerGoogle__auto_generated_rro_vendor.apk"
    "overlay/SystemUIGoogle__auto_generated_rro_vendor.apk"

    # Symlinks
    "app/CneApp/lib/arm64/libvndfwk_detect_jni.qti.so"
    "lib/libEGL_adreno.so"
    "lib/libGLESv2_adreno.so"
    "lib/libq3dtools_adreno.so"
    "lib64/libEGL_adreno.so"
    "lib64/libGLESv2_adreno.so"
    "lib64/libq3dtools_adreno.so"
    "rfs/apq/gnss/hlos"
    "rfs/apq/gnss/ramdumps"
    "rfs/apq/gnss/readonly/firmware"
    "rfs/apq/gnss/readonly/vendor/firmware"
    "rfs/apq/gnss/readwrite"
    "rfs/apq/gnss/shared"
    "rfs/mdm/adsp/hlos"
    "rfs/mdm/adsp/ramdumps"
    "rfs/mdm/adsp/readonly/firmware"
    "rfs/mdm/adsp/readonly/vendor/firmware"
    "rfs/mdm/adsp/readwrite"
    "rfs/mdm/adsp/shared"
    "rfs/mdm/cdsp/hlos"
    "rfs/mdm/cdsp/ramdumps"
    "rfs/mdm/cdsp/readonly/firmware"
    "rfs/mdm/cdsp/readwrite"
    "rfs/mdm/cdsp/shared"
    "rfs/mdm/mpss/hlos"
    "rfs/mdm/mpss/ramdumps"
    "rfs/mdm/mpss/readonly/firmware"
    "rfs/mdm/mpss/readonly/vendor/firmware"
    "rfs/mdm/mpss/readwrite"
    "rfs/mdm/mpss/shared"
    "rfs/mdm/slpi/hlos"
    "rfs/mdm/slpi/ramdumps"
    "rfs/mdm/slpi/readonly/firmware"
    "rfs/mdm/slpi/readwrite"
    "rfs/mdm/slpi/shared"
    "rfs/mdm/tn/hlos"
    "rfs/mdm/tn/ramdumps"
    "rfs/mdm/tn/readonly/firmware"
    "rfs/mdm/tn/readwrite"
    "rfs/mdm/tn/shared"
    "rfs/msm/adsp/hlos"
    "rfs/msm/adsp/ramdumps"
    "rfs/msm/adsp/readonly/firmware"
    "rfs/msm/adsp/readonly/vendor/firmware"
    "rfs/msm/adsp/readwrite"
    "rfs/msm/adsp/shared"
    "rfs/msm/cdsp/hlos"
    "rfs/msm/cdsp/ramdumps"
    "rfs/msm/cdsp/readonly/firmware"
    "rfs/msm/cdsp/readonly/vendor/firmware"
    "rfs/msm/cdsp/readwrite"
    "rfs/msm/cdsp/shared"
    "rfs/msm/mpss/hlos"
    "rfs/msm/mpss/ramdumps"
    "rfs/msm/mpss/readonly/firmware"
    "rfs/msm/mpss/readonly/vendor/firmware"
    "rfs/msm/mpss/readwrite"
    "rfs/msm/mpss/shared"
    "rfs/msm/slpi/hlos"
    "rfs/msm/slpi/ramdumps"
    "rfs/msm/slpi/readonly/firmware"
    "rfs/msm/slpi/readonly/vendor/firmware"
    "rfs/msm/slpi/readwrite"
    "rfs/msm/slpi/shared"

    # Exclude files that compile with BUILD_WITHOUT_VENDOR := false
    # or manually added as build targets in device-lineage.mk

    # Bluetooth
    "lib/android.hardware.bluetooth@1.0.so"
    "lib/android.hardware.bluetooth@1.1.so"
    "lib/hardware.google.bluetooth.bt_channel_avoidance@1.0.so"
    "lib/hardware.google.bluetooth.sar@1.0.so"
    "lib/vendor.qti.hardware.bluetooth_audio@2.0.so"
    "lib64/android.hardware.bluetooth@1.0.so"
    "lib64/android.hardware.bluetooth@1.1.so"
    "lib64/hardware.google.bluetooth.bt_channel_avoidance@1.0.so"
    "lib64/hardware.google.bluetooth.sar@1.0.so"
    "lib64/vendor.qti.hardware.bluetooth_audio@2.0.so"

    # Camera
    "lib64/android.hardware.camera.common@1.0.so"
    "lib64/android.hardware.camera.device@1.0.so"
    "lib64/android.hardware.camera.device@3.2.so"
    "lib64/android.hardware.camera.provider@2.4.so"

    # CHRE
    "bin/chre"
    "etc/init/chre_daemon.rc"

    # Codec2
    "lib/android.hardware.media.c2@1.0.so"
    "lib/libcodec2_hidl@1.0.so"
    "lib/libcodec2_hidl_plugin.so"
    "lib/libcodec2_vndk.so"
    "lib/libmedia_ecoservice.so"
    "lib/libstagefright_bufferpool@2.0.1.so"
    "lib64/android.hardware.media.c2@1.0.so"
    "lib64/libavservices_minijail.so"
    "lib64/libcodec2_hidl@1.0.so"
    "lib64/libcodec2_hidl_plugin.so"
    "lib64/libcodec2_vndk.so"
    "lib64/libmedia_ecoservice.so"
    "lib64/libstagefright_bufferpool@2.0.1.so"

    # Confirmation UI
    "lib64/android.hardware.confirmationui@1.0.so"
    "lib64/libteeui_hal_support.so"

    # Display
    "bin/hw/vendor.qti.hardware.display.allocator-service"
    "bin/hw/vendor.qti.hardware.display.composer-service"
    "etc/init/vendor.qti.hardware.display.allocator-service.rc"
    "etc/init/vendor.qti.hardware.display.composer-service.rc"
    "etc/vintf/manifest/android.hardware.graphics.mapper-impl-qti-display.xml"
    "etc/vintf/manifest/vendor.qti.hardware.display.allocator-service.xml"
    "etc/vintf/manifest/vendor.qti.hardware.display.composer-service.xml"
    "etc/vintf/manifest/pixel-display-default.xml"
    "lib/hw/android.hardware.graphics.mapper@3.0-impl-qti-display.so"
    "lib/hw/android.hardware.graphics.mapper@4.0-impl-qti-display.so"
    "lib/hw/gralloc.lito.so"
    "lib/hw/memtrack.lito.so"
    "lib/libdisplayconfig.qti.so"
    "lib/libdisplaydebug.so"
    "lib/libdrm.so"
    "lib/libdrmutils.so"
    "lib/libgralloc.qti.so"
    "lib/libgralloccore.so"
    "lib/libgrallocutils.so"
    "lib/libqdMetaData.so"
    "lib/libqdutils.so"
    "lib/libqservice.so"
    "lib/libsdedrm.so"
    "lib/libsdmcore.so"
    "lib/libsdmutils.so"
    "lib/vendor.display.config@1.0.so"
    "lib/vendor.display.config@2.0.so"
    "lib/vendor.qti.hardware.display.mapper@1.0.so"
    "lib/vendor.qti.hardware.display.mapper@1.1.so"
    "lib/vendor.qti.hardware.display.mapper@2.0.so"
    "lib/vendor.qti.hardware.display.mapper@3.0.so"
    "lib/vendor.qti.hardware.display.mapper@4.0.so"
    "lib/vendor.qti.hardware.display.mapperextensions@1.0.so"
    "lib/vendor.qti.hardware.display.mapperextensions@1.1.so"
    "lib64/android.hardware.graphics.composer@2.1.so"
    "lib64/android.hardware.graphics.composer@2.2.so"
    "lib64/android.hardware.graphics.composer@2.3.so"
    "lib64/android.hardware.graphics.composer@2.4.so"
    "lib64/com.google.hardware.pixel.display-V1-ndk.so"
    "lib64/hw/android.hardware.graphics.mapper@3.0-impl-qti-display.so"
    "lib64/hw/android.hardware.graphics.mapper@4.0-impl-qti-display.so"
    "lib64/hw/gralloc.lito.so"
    "lib64/hw/memtrack.lito.so"
    "lib64/libdisplayconfig.qti.so"
    "lib64/libdisplaydebug.so"
    "lib64/libdrm.so"
    "lib64/libdrmutils.so"
    "lib64/libgpu_tonemapper.so"
    "lib64/libgralloc.qti.so"
    "lib64/libgralloccore.so"
    "lib64/libgrallocutils.so"
    "lib64/libhistogram.so"
    "lib64/libqdMetaData.so"
    "lib64/libqdutils.so"
    "lib64/libqservice.so"
    "lib64/libsdedrm.so"
    "lib64/libsdmcore.so"
    "lib64/libsdmutils.so"
    "lib64/vendor.display.config@1.0.so"
    "lib64/vendor.display.config@1.1.so"
    "lib64/vendor.display.config@1.2.so"
    "lib64/vendor.display.config@1.3.so"
    "lib64/vendor.display.config@1.4.so"
    "lib64/vendor.display.config@1.5.so"
    "lib64/vendor.display.config@1.6.so"
    "lib64/vendor.display.config@1.7.so"
    "lib64/vendor.display.config@1.8.so"
    "lib64/vendor.display.config@1.9.so"
    "lib64/vendor.display.config@2.0.so"
    "lib64/vendor.qti.hardware.display.allocator@3.0.so"
    "lib64/vendor.qti.hardware.display.allocator@4.0.so"
    "lib64/vendor.qti.hardware.display.composer@3.0.so"
    "lib64/vendor.qti.hardware.display.mapper@1.0.so"
    "lib64/vendor.qti.hardware.display.mapper@1.1.so"
    "lib64/vendor.qti.hardware.display.mapper@2.0.so"
    "lib64/vendor.qti.hardware.display.mapper@3.0.so"
    "lib64/vendor.qti.hardware.display.mapper@4.0.so"
    "lib64/vendor.qti.hardware.display.mapperextensions@1.0.so"
    "lib64/vendor.qti.hardware.display.mapperextensions@1.1.so"

    # GNSS
    "bin/hw/android.hardware.gnss@2.1-service-qti"
    "etc/flp.conf"
    "etc/init/android.hardware.gnss@2.1-service-qti.rc"
    "etc/vintf/manifest/android.hardware.gnss@2.1-service-qti.xml"
    "lib/android.hardware.gnss.measurement_corrections@1.0.so"
    "lib/android.hardware.gnss.measurement_corrections@1.1.so"
    "lib/android.hardware.gnss.visibility_control@1.0.so"
    "lib/android.hardware.gnss@1.0.so"
    "lib/android.hardware.gnss@1.1.so"
    "lib/android.hardware.gnss@2.0.so"
    "lib/android.hardware.gnss@2.1.so"
    "lib/hw/android.hardware.gnss@2.1-impl-qti.so"
    "lib64/android.hardware.gnss.measurement_corrections@1.0.so"
    "lib64/android.hardware.gnss.measurement_corrections@1.1.so"
    "lib64/android.hardware.gnss.visibility_control@1.0.so"
    "lib64/android.hardware.gnss@1.0.so"
    "lib64/android.hardware.gnss@1.1.so"
    "lib64/android.hardware.gnss@2.0.so"
    "lib64/android.hardware.gnss@2.1.so"
    "lib64/hw/android.hardware.gnss@2.1-impl-qti.so"

    # HIDL
    "lib/libhidltransport.so"
    "lib/libhwbinder.so"
    "lib64/libhidltransport.so"
    "lib64/libhwbinder.so"

    # Identity credential
    "etc/permissions/android.hardware.identity_credential.xml"
    "lib64/android.hardware.identity-support-lib.so"
    "lib64/libcppbor_external.so"
    "lib64/libcppcose_rkp.so"
    "lib64/libkeymaster_messages.so"
    "lib64/libkeymaster_portable.so"
    "lib64/libpuresoftkeymasterdevice.so"
    "lib64/libsoft_attestation_cert.so"

    # Json
    "lib/libjson.so"
    "lib64/libjson.so"

    # Light
    "lib/hw/lights.lito.so"
    "lib64/hw/lights.lito.so"

    # Media
    "lib/libOmxCore.so"
    "lib/libOmxVdec.so"
    "lib/libOmxVenc.so"
    "lib/libc2dcolorconvert.so"
    "lib/libmm-omxcore.so"
    "lib/libplatformconfig.so"
    "lib/libstagefrighthw.so"
    "lib/vendor.qti.hardware.capabilityconfigstore@1.0.so"
    "lib64/libOmxCore.so"
    "lib64/libOmxVdec.so"
    "lib64/libOmxVenc.so"
    "lib64/libc2dcolorconvert.so"
    "lib64/libmm-omxcore.so"
    "lib64/libplatformconfig.so"
    "lib64/libstagefrighthw.so"
    "lib64/vendor.qti.hardware.capabilityconfigstore@1.0.so"

    # Nos
    "lib64/libnos.so"
    "lib64/libnos_client_citadel.so"
    "lib64/libnos_datagram.so"
    "lib64/libnos_datagram_citadel.so"
    "lib64/libnos_transport.so"
    "lib64/libnosprotos.so"
    "lib64/nos_app_avb.so"
    "lib64/nos_app_identity.so"
    "lib64/nos_app_keymaster.so"
    "lib64/nos_app_weaver.so"

    # Power
    "lib/android.hardware.power@1.0.so"
    "lib/android.hardware.power@1.1.so"
    "lib/android.hardware.power@1.2.so"
    "lib/android.hardware.power-V1-ndk.so"
    "lib64/android.hardware.power@1.0.so"
    "lib64/android.hardware.power@1.1.so"
    "lib64/android.hardware.power@1.2.so"

    # Protobuf
    "lib/libprotobuf-cpp-full.so"
    "lib64/libprotobuf-cpp-full.so"

    # Sensors
    "bin/hw/android.hardware.sensors@2.0-service.multihal"
    "etc/init/android.hardware.sensors@2.0-service-multihal.rc"
    "etc/permissions/android.hardware.sensor.accelerometer.xml"
    "etc/permissions/android.hardware.sensor.barometer.xml"
    "etc/permissions/android.hardware.sensor.compass.xml"
    "etc/permissions/android.hardware.sensor.gyroscope.xml"
    "etc/permissions/android.hardware.sensor.hifi_sensors.xml"
    "etc/permissions/android.hardware.sensor.light.xml"
    "etc/permissions/android.hardware.sensor.proximity.xml"
    "etc/permissions/android.hardware.sensor.stepcounter.xml"
    "etc/permissions/android.hardware.sensor.stepdetector.xml"
    "etc/vintf/manifest/android.hardware.sensors@2.0-multihal.xml"
    "lib/android.hardware.sensors@1.0.so"
    "lib/android.hardware.sensors@2.0-ScopedWakelock.so"
    "lib/android.hardware.sensors@2.0.so"
    "lib/android.hardware.sensors@2.1.so"
    "lib64/android.hardware.sensors@2.0-ScopedWakelock.so"
    "lib64/android.hardware.sensors@2.0.so"
    "lib64/android.hardware.sensors@2.1.so"

    # Sensor listener
    "lib64/lib_sensor_listener.so"

    # Tether offload
    "lib64/android.hardware.tetheroffload.config@1.0.so"
    "lib64/android.hardware.tetheroffload.control@1.0.so"
    "lib64/libnetfilter_conntrack.so"
    "lib64/libnfnetlink.so"

    # Tinycompress
    "lib/libtinycompress.so"
    "lib64/libtinycompress.so"

    # VNDK FWK detect
    "lib/libqti_vndfwk_detect.so"
    "lib/libvndfwk_detect_jni.qti.so"
    "lib64/libqti_vndfwk_detect.so"
    "lib64/libvndfwk_detect_jni.qti.so"

    # Wi-Fi
    "lib/libcld80211.so"
    "lib/libwifi-hal-ctrl.so"
    "lib/libwifi-hal-qcom.so"
    "lib64/libwifi-hal-ctrl.so"
    "lib64/libwifi-hal-qcom.so"

    # Misc interfaces
    "lib/android.frameworks.sensorservice@1.0.so"
    "lib/android.hardware.authsecret@1.0.so"
    "lib/android.hardware.gatekeeper@1.0.so"
    "lib/android.hardware.keymaster@3.0.so"
    "lib/android.hardware.keymaster@4.0.so"
    "lib/android.hardware.keymaster@4.1.so"
    "lib/android.hardware.thermal@1.0.so"
    "lib/android.hardware.thermal@2.0.so"
    "lib/android.hidl.memory.block@1.0.so"
    "lib/vendor.qti.hardware.systemhelper@1.0.so"
    "lib64/android.frameworks.stats@1.0.so"
    "lib64/android.hardware.authsecret@1.0.so"
    "lib64/android.hardware.biometrics.fingerprint@2.1.so"
    "lib64/android.hardware.biometrics.fingerprint@2.2.so"
    "lib64/android.hardware.gatekeeper@1.0.so"
    "lib64/android.hardware.input.common-V1-ndk.so"
    "lib64/android.hardware.input.processor-V1-ndk.so"
    "lib64/android.hardware.neuralnetworks@1.0.so"
    "lib64/android.hardware.neuralnetworks@1.1.so"
    "lib64/android.hardware.neuralnetworks@1.2.so"
    "lib64/android.hardware.neuralnetworks@1.3.so"
    "lib64/android.hardware.oemlock@1.0.so"
    "lib64/android.hardware.radio.config@1.0.so"
    "lib64/android.hardware.radio.config@1.1.so"
    "lib64/android.hardware.radio.config@1.2.so"
    "lib64/android.hardware.radio.deprecated@1.0.so"
    "lib64/android.hardware.radio@1.2.so"
    "lib64/android.hardware.radio@1.3.so"
    "lib64/android.hardware.radio@1.4.so"
    "lib64/android.hardware.radio@1.5.so"
    "lib64/android.hardware.weaver@1.0.so"
    "lib64/android.hidl.memory.block@1.0.so"
    "lib64/android.system.net.netd@1.0.so"
    "lib64/android.system.net.netd@1.1.so"
    "lib64/vendor.qti.hardware.camera.postproc@1.0.so"
    "lib64/vendor.qti.hardware.systemhelper@1.0.so"

    # Completely skip files that are not required

    # Cryptfshw
    "etc/init/vendor.qti.hardware.cryptfshw@1.0-service-qti.rc"
    "lib/libcryptfshwcommon.so"
    "lib/vendor.qti.hardware.cryptfshw@1.0.so"
    "lib64/libcryptfshwcommon.so"
    "lib64/vendor.qti.hardware.cryptfshw@1.0.so"

    # Fingerprint
    "lib/android.hardware.biometrics.fingerprint@2.1.so"

    # Google
    "etc/default-permissions/default-permissions_talkback.xml"

    # IOP
    "lib/vendor.qti.hardware.iop@1.0.so"
    "lib64/vendor.qti.hardware.iop@1.0.so"

    # Perf
    "lib/vendor.qti.hardware.perf@1.0.so"
    "lib/vendor.qti.hardware.perf@2.0.so"
    "lib/vendor.qti.hardware.perf@2.1.so"
    "lib64/vendor.qti.hardware.perf@1.0.so"
    "lib64/vendor.qti.hardware.perf@2.0.so"
    "lib64/vendor.qti.hardware.perf@2.1.so"

    # Wi-Fi display
    "lib/libFileMux_proprietary.so"
    "lib/libmmrtpdecoder_proprietary.so"
    "lib/libmmrtpencoder_proprietary.so"
    "lib/libwfdcommonutils_proprietary.so"
    "lib/libwfdconfigutils_proprietary.so"
    "lib/libwfddisplayconfig_proprietary.so"
    "lib/libwfdmminterface_proprietary.so"
    "lib/libwfdrtsp_proprietary.so"
    "lib/libwfduibcinterface_proprietary.so"
    "lib/libwfduibcsink_proprietary.so"
    "lib/libwfduibcsinkinterface_proprietary.so"
    "lib/libwfduibcsrc_proprietary.so"
    "lib/libwfduibcsrcinterface_proprietary.so"
    "lib/vendor.qti.hardware.sigma_miracast@1.0.so"
    "lib64/libwfddisplayconfig_proprietary.so"
    "lib64/vendor.qti.hardware.sigma_miracast@1.0.so"
)

# Initialize the helper
setup_vendor_deps "${ANDROID_ROOT}"

generate_prop_list_from_image "${_input_image}" "${_output_file}" VENDOR_SKIP_FILES

# Fixups
function presign() {
    sed -i "s|vendor/${1}$|vendor/${1};PRESIGNED|g" "${_output_file}"
}

function as_module() {
    sed -i "s|vendor/${1}$|-vendor/${1}|g" "${_output_file}"
}

function header() {
    sed -i "1s/^/${1}\n/" "${_output_file}"
}

presign "app/adreno_graphics_driver/adreno_graphics_driver.apk"
as_module "lib/libadsprpc.so"
as_module "lib/libfastcvopt.so"
as_module "lib/libMpeg4SwEncoder.so"
as_module "lib64/libadsprpc.so"
as_module "lib64/libfastcvopt.so"
as_module "lib64/libMpeg4SwEncoder.so"
as_module "lib64/libthermalclient.so"

header "# All blobs are extracted from Google factory images for each new ASB"
